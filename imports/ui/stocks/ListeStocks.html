<template name="ListeStocks">
	<h3>Liste des stocks</h3>

	<section class="stocks">
		{{#if Template.subscriptionsReady}}
			<table class="table-donnees">
				<tr>
					<th class="colonne-icone"></th>
					<th class="colonne-site">Libelle</th>
					<th class="colonne-site">Quantit√©</th>
					<th class="colonne-site">Services</th>
					<th class="colonne-site">Statut</th>
				</tr>
				{{#each stocks}}
					<tr class="row-donnees {{#if avertissement}}{{#if alerte}}warning-al{{else}}warning-av{{/if}}{{/if}}">

						<td>
							<div class="dropdown">
							  <span class="glyphicon glyphicon-cog  dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"></span>
							  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
							  	<li>Niveau de seuil</li>
							    <li><button id="augmenteS-{{_id}}" class="glyphicon glyphicon-minus decrease-seuil"></button>
								<button id="diminueS-{{_id}}" class="glyphicon glyphicon-plus increase-seuil"></button>  {{seuil}}</li>
							    <li role="separator" class="divider"></li>
							    <li>Niveau d'avertissement</li>
							    <li>
							    	<button id="augmenteA-{{_id}}" class="glyphicon glyphicon-minus decrease-avertissement"></button>
									<button id="diminueA-{{_id}}" class=" glyphicon glyphicon-plus increase-avertissement"></button>  {{nvAvertissement}}
								</li>
							  </ul>
							</div>
						</td>
						<td>
							{{libelle}}
						</td>
						<td>
							<button id="diminueQ-{{_id}}" class="btn btn-default btn-sm decrease-quantity glyphicon glyphicon-minus"></button>
							<button id="augmenteQ-{{_id}}" class="btn btn-default glyphicon glyphicon-plus increase-quantity"></button>  {{quantite}}
						</td>
						<td>
							{{#each service}}
					        	<button id="consommer-{{../_id}}" class="btn btn-default btn-sm glyphicon glyphicon-share consommer" data-id="{{../_id}}"></button>  {{nom}} -
					        	<span class="dropdown">
								  <a href="" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"><span class="badge">{{consommation}}</span></a>
								  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"  data-id="{{../_id}}">
								  	{{#each (limit historique -6)}}
								  		{{#with getHistorique this}}
								            <li class=""><button class="glyphicon glyphicon-remove-sign consommations-remove" onClick="getGrandParentDataId(this);"></button>{{objet}}-{{date}}</li>
								        {{/with}}
								  	{{/each}}
								  </ul>
								</span>
								<br />
								<!-- <button id="augmenteQl-{{../_id}}" class="glyphicon glyphicon-plus increase-quantity-lieu" data-id="{{../_id}}"></button> -->
					      	{{/each}}
						</td>
						<td>
							{{#if avertissement}}
								{{#if alerte}}
									ALERTE
								{{else}}
									Avertissement
								{{/if}}
							{{else}}
								OK
							{{/if}}
						</td>
					</tr>
				{{/each}}
			</table>
		{{else}}
			<p>En attente</p>
		{{/if}}
	</section>
<br /><br /><br />

	<section>
		<div style="border: thin solid black">
			<h5>INFORMATION</h5>
			<i>Stock insuffisant pour les objets suivants:
			<ul>
			{{#each infoAlerte}}
			<li>{{libelle}}</li>
			{{/each}}
			</ul></i>
		</div>
		<div style="border: thin solid black">
			<h5>HISTORIQUE</h5>
			<i>
			<ul class="check-object">
			{{#each consommations}}
			<li class="check-object">{{service}} // {{objet}} le {{ date }}.----------- {{_id}}</li>
			{{/each}}
			</ul></i>
		</div>
	</section>

<script type="text/javascript">

</script>
</template>
